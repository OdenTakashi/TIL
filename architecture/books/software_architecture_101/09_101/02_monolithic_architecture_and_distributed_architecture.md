# ソフトウェアアーキテクチャの基礎 -エンジアリングに基づく体系的なアプローチ-
- Mark Richards, Near Ford 著
- 島田浩二 訳

## モノシリックアーキテクチャと分散アーキテクチャ
- モノシリック
  - すべてのコード単一のデプロイメントユニット
  - レイヤードアーキテクチャ
  - パイプラインアーキテクチャ
  - マイクロカーネルアアーキテクチャ
- 分散型
  - リモートアクセスプロトコルを介して接続された複数でデプロイメントユニットで構成されているもの
  - サービスベースアーキテクチュ
  - イベント駆動
  - スペースベース
  - サービス指向
  - マイクロサービス
  - パフォーマンス、可用性、スケーラビリティの面で強力
    - 強烈なトレードオフがある==誤信

### ネットワークは信頼できる
- ネットワークの信頼性は低い
  - リクエストのレスポンスが帰ってこないことは全然ある
    - タイムアウトやサーキーとブレーカーが存在する理由
      - 依存すればするほど、信頼性が低下する

### レイテンシーが0
- アプリ間通信には時間がかかるモノである
  - 90~95%が何秒かかっているかを知る必要がある
    - 平均が60m秒でも95%は400m秒かもしれない

### 帯域幅は無限
- 大量のデータやりとりでは帯域を消費するため、遅くなったりしてしまう。
  - スタンプ結合(不要なデータをもらうことで、複数の型を知っておく必要があること)をしていると速度低下、レイテンシー、信頼性の低下につながる
- 専用なAPIは作成し不要データを返さないようにする
- GraphQLを利用し、必要な情情報だけ分離できる
-> 必要な情報のみを受け取らせる

### ネットワークは安全
- 分散アーキテクチャにすると攻撃される面積が増える
  - すべてのアプリをセキュアにする必要があり、パフォーマンスが遅くなりがち
  - アプリにアクセスが届かない設計が必要

### トポロジーは変化しない
- ルーター、ハブ、スイッチ、FW、ネットワーク、などが変化されるの可能性はある

### 管理者は1人だけ
- ネットワーク管理者は多数いるため、相談相手も増える

### 転送コストは0
- アプリの数だけネットワークが必要になるため、モノシリックよりもコストは嵩む

### ネットワークは均一
- ネネットワークハーベンダーごとに互換性の違いなどがある

## 分散コンピューティングにおけるその他の考慮事項
### 分散ロギング
- ログが分散されるため、バグの発見が遅れる
- フォーマットもそれぞれによって異なる

### 分散トランザクション
- 単一アプリであればACID特性が考慮され、一貫性か完全性が保証される
- 一定のタイミングで同期することで全てが一貫された状態になる == 結果整合性
  - 整合性や完全性を犠牲に、パフォーマンス、スケーラビリティを得ている
  - トレードオフである
- トランザクションサーガ
  - トランザクション状態を管理するため、補償用のイベントソーシングか、有限状態機械のどちらかを利用する
  - 各ステップをイベントとして記録
  - 失敗時は記録を元に補償トランザクションの実行
- BASEトランザクション
  - 常に応答を返す
  - ソフト状態: システムは時間経過で変化
  - 結果整合性

### コントラクトのメンテナンスバージョン管理
- I/Fの変更があると連結が難しくなる
- バージョン互換性が発生する
